<!DOCTYPE html>
<html>
<head>
    <title>My Route Planner (Firebase + Path)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <style>
        body { 
            font-family: sans-serif; 
            margin: 10px; 
            display: flex; 
            flex-direction: column; 
        }
        h1 {
            margin-bottom: 10px;
        }
        #auth-container { 
            margin-bottom: 10px; 
            padding: 8px; 
            background-color: #f0f0f0; 
            border-radius: 5px; 
            display: flex; 
            align-items: center; 
        }
        #auth-container button { 
            margin: 0 5px; 
            padding: 8px 12px; 
            border: 1px solid #ccc;
            background-color: #fff;
            cursor: pointer;
            border-radius: 4px;
        }
        #auth-container button:hover {
            background-color: #e9e9e9;
        }
        #user-info { 
            margin: 0 10px; 
            font-weight: bold;
        }
        .instructions { 
            margin-bottom: 15px;
            line-height: 1.6;
        }

        /* --- Style for the Start Path / End Path button --- */
        #toggle-path-button { 
            display: inline-block; /* Allows setting padding/margin, width adjusts to content */
            width: auto;           /* Ensures width is based on content, not full container width */
            padding: 10px 15px;
            background-color: #007bff; /* Blue color for primary action */
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 15px; 
            text-align: center;
            /* The inline style="display: none;" in HTML will be overridden by JS when user logs in */
        }
        #toggle-path-button:hover {
            background-color: #0056b3; /* Darker blue on hover */
        }
        #toggle-path-button.active { /* Style when path creation is active */
            background-color: #dc3545; /* Red color for "End Path" state */
        }

        .main-container { 
            display: flex; 
            flex-wrap: wrap; 
        }
        .map-area { 
            flex-grow: 1; 
            min-width: 300px; 
        }
        #map { 
            height: 500px; 
            width: 100%; 
            border: 1px solid #ccc; 
            position: relative; 
        }
        .infowindow-content { 
            width: 200px; 
        }
        .infowindow-content textarea { 
            width: 95%; 
            margin-top: 5px; 
            margin-bottom: 5px; 
        }

        /* --- Legend Styles --- */
        #legend-container {
            width: 220px; 
            max-height: 500px; 
            overflow-y: auto; 
            border: 1px solid #ccc;
            padding: 10px;
            margin-left: 10px; 
            background-color: #f9f9f9;
            border-radius: 5px; 
        }
        #legend-container h4 { 
            margin-top: 0; 
            font-size: 1.1em; 
            border-bottom: 1px solid #eee; 
            padding-bottom: 5px;
            margin-bottom: 10px;
        }
        #legend-list { 
            list-style: none; 
            padding: 0; 
            margin: 0; 
        }
        #legend-list li { 
            margin-bottom: 8px; 
            display: flex; 
            align-items: center; 
        }
        #legend-list input[type="checkbox"] { 
            margin-right: 8px; 
            cursor: pointer;
        }
        #legend-list label { 
            display: inline-flex; 
            align-items: center; 
            cursor: pointer; 
        }
        
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            #legend-container {
                width: 100%; 
                margin-left: 0;
                margin-top: 10px; 
            }
        }
    </style>
</head>
<body>
    <h1>Travel Plans (Live Sharing)</h1> 
    
    <div id="auth-container">
        <button id="sign-in-button" style="display: none;">Sign In with Google</button>
        <span id="user-info" style="display: none;"></span> 
        <button id="sign-out-button" style="display: none;">Sign Out</button>
    </div>

    <p class="instructions">
        Instructions: Login. Left-click map to add YOUR stops. Left-click YOUR markers to edit notes, Right-click YOUR markers to remove. 
        Use Legend to the right of map to show/hide users. Define YOUR path using 'Start/End Path' bar & clicking markers.
    </p>
    
    <button id="toggle-path-button" style="display: none;">Start Path</button>

    <div class="main-container">
        <div id="map" class="map-area"></div>
        <div id="legend-container">
            </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

    <script>
        // Your Firebase configuration object
        const firebaseConfig = {
            apiKey: "AIzaSyBczrD-6WlGdqWwTxnUNpE09fd81TjE_FA", // From your earlier code
            authDomain: "travel-app-465e4.firebaseapp.com",
            projectId: "travel-app-465e4",
            storageBucket: "travel-app-465e4.appspot.com", // Please verify this: .appspot.com or .firebasestorage.app
            messagingSenderId: "381511835838",
            appId: "1:381511835838:web:c340bab9da6616f4f83eef"
        };   
    </script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAFouD3ULMBaEiyw4a62Tr5BIivTTcyVkE&callback=initMap&v=weekly" async defer></script>
    <script src="app.js" defer></script>

</body>
</html>
